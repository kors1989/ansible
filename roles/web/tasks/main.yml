- name: 1. install Apache
  yum: name=httpd state=latest

- name: 2. install PHP module for Apache
  yum: name=php state=latest

- name: 3. install PHP module to work with MariaDB
  yum: name=php-mysql state=latest

- name: 4. install SE Linux modules
  yum: name={{ item }} state=present
  with_items:
    - libsemanage-python
    - libselinux-python
  
- name: 5. start Apache
  service: name=httpd state=started enabled=yes

- name: 6. create the index.php file
  template: src=index.php.j2 dest=/var/www/html/index.php
  
- name: 7. open 80 port in firewall
  command: firewall-cmd --zone=public --add-port=80/tcp --permanent

- name: 8. reload firewall
  command: firewall-cmd --reload
  
- name: 9. configure SELinux
  seboolean: name=httpd_can_network_connect_db state=true persistent=yes
  when: sestatus.rc != 0